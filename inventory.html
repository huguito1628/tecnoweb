<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inventario - Abba Jhire Corporation</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="dashboard.css" />

  <style>
    body { display: none; }

    @media (max-width: 768px) {
      .sidebar { transform: translateX(-100%); transition: transform 0.3s ease-in-out; z-index: 1050; }
      .sidebar.show-sidebar { transform: translateX(0); }
      .main-content { margin-left: 0; transition: margin-left 0.3s ease-in-out; }
      #closeSidebar { position: absolute; top: 10px; right: 10px; z-index: 1100; float: none !important; }
    }

    @media (min-width: 769px) {
      .main-content { margin-left: 250px; }
      .sidebar { width: 250px; }
    }

    .inventory-card {
      background-color: #2b2d30;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .inventory-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
      border-color: #fff;
    }

    .product-image {
      height: 150px;
      object-fit: contain;
      width: 100%;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 6px 6px 0 0;
      background-color: rgba(255, 255, 255, 0.05);
    }

    .stock-indicator {
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: bold;
      font-size: 0.8rem;
    }

    .low-stock {
      background-color: rgba(255, 0, 0, 0.2);
      color: #ff4444;
    }

    .in-stock {
      background-color: rgba(0, 255, 0, 0.2);
      color: #00ff00;
    }

    .search-input-group .form-control {
      background-color: #1e1e1e;
      color: #fff;
      border-color: rgba(255, 255, 255, 0.2);
    }

    .search-input-group .input-group-text {
      background-color: #fff;
      color: #000;
      border-color: #fff;
    }
  </style>

  <script>
    const sessionActive = localStorage.getItem('sessionActive');
    const sessionUser = localStorage.getItem('sessionUser');
    if (sessionActive !== 'true' || !sessionUser) {
      window.location.href = 'auth.html';
    } else {
      document.addEventListener('DOMContentLoaded', () => {
        document.body.style.display = 'block';
      });
    }
  </script>
</head>

<body class="bg-dark text-light">

  <div class="dashboard-wrapper">
    <aside class="sidebar bg-dark position-fixed h-100" id="sidebar">
      <button class="btn btn-light d-md-none m-2" id="closeSidebar">
        <i class="bi bi-x-lg fs-4"></i>
      </button>
      <div class="brand mt-4">
        <h2>ABBA<br><span>JHIRE</span></h2>
      </div>
      <ul class="menu">
        <li><a href="index.html" class="menu-link"><i class="bi bi-speedometer2"></i> <span>Inicio</span></a></li>
        <li><a href="users.html" class="menu-link"><i class="bi bi-people"></i> <span>Usuarios</span></a></li>
        <li class="active"><a href="inventory.html" class="menu-link"><i class="bi bi-box-seam"></i> <span>Inventario</span></a></li>
        <li><a href="reports.html" class="menu-link"><i class="bi bi-bar-chart"></i> <span>Reportes</span></a></li>
        <li><a href="settings.html" class="menu-link"><i class="bi bi-gear"></i> <span>Configuración</span></a></li>
      </ul>
      <button id="logoutBtn" class="logout-btn"><i class="bi bi-box-arrow-right"></i> Cerrar sesión</button>
    </aside>

    <main class="main-content">
      <header class="topbar d-flex justify-content-between align-items-center">
        <button class="btn btn-outline-light d-md-none" id="menuToggle"><i class="bi bi-list fs-2"></i></button>
        <h3 class="mb-0"><i class="bi bi-box-seam"></i> Gestión de Inventario</h3>
      </header>

      <section class="content-section">
        <div class="row mb-4 align-items-end">
          <div class="col-12 col-md-6 mb-3 mb-md-0">
            <label for="searchInput" class="form-label text-secondary">Buscar Producto</label>
            <div class="input-group search-input-group">
              <input type="text" class="form-control" id="searchInput" placeholder="Buscar por nombre o ID...">
              <span class="input-group-text"><i class="bi bi-search"></i></span>
            </div>
          </div>

          <div class="col-6 col-md-3">
            <label for="categoryFilter" class="form-label text-secondary">Categoría</label>
            <select class="form-select bg-dark text-light border-secondary" id="categoryFilter">
              <option value="all">Todas</option>
              <option value="Audio">Audio</option>
              <option value="Tecnología">Tecnología</option>
            </select>
          </div>

          <div class="col-6 col-md-3">
            <label for="priceFilter" class="form-label text-secondary">Ordenar por Precio</label>
            <select class="form-select bg-dark text-light border-secondary" id="priceFilter">
              <option value="default">Por defecto</option>
              <option value="asc">Menor a Mayor</option>
              <option value="desc">Mayor a Menor</option>
            </select>
          </div>
        </div>

        <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 row-cols-xl-4 g-4" id="productList"></div>

        <div class="col-12 d-none text-center py-5" id="noResultsMessage">
          <i class="bi bi-exclamation-octagon display-4 text-secondary"></i>
          <p class="mt-3 fs-5 text-secondary">No se encontraron productos que coincidan con los filtros aplicados.</p>
        </div>
      </section>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const productos = [
      { id: "SC-57BT", producto: "Scorpion SC-57BT", marca: "Scorpion", categoria: "Audio", stock: 7, precio: 90.0, imagen: "images/SC-57BT.jpg" },
      { id: "SH-PGA48", producto: "Shure PGA-48", marca: "Shure", categoria: "Audio", stock: 3, precio: 120.0, imagen: "images/SH-PGA48.jpg" },
      { id: "SH-PGA58-R", producto: "Shure PGA-58 (réplica)", marca: "Shure", categoria: "Audio", stock: 3, precio: 80.0, imagen: "images/SH-PGA58-R.jpg" },
      { id: "SH-SM58-R", producto: "Shure SM-58 (réplica)", marca: "Shure", categoria: "Audio", stock: 2, precio: 100.0, imagen: "images/SH-SM58-R.jpg" },
      { id: "SH-BETA57A", producto: "Shure Beta 57A", marca: "Shure", categoria: "Audio", stock: 2, precio: 130.0, imagen: "images/SH-BETA57A.jpg" },
      { id: "HM-01", producto: "Máquina de humo (unidad)", marca: "Genérica", categoria: "Tecnología", stock: 2, precio: 130.0, imagen: "images/HM-01.jpg" },
      { id: "EALSEN-1", producto: "Micrófono inalámbrico Ealsen", marca: "Ealsen", categoria: "Audio", stock: 2, precio: 120.0, imagen: "images/EALSEN-1.jpg" },
      { id: "ONTOP-HIGH", producto: "Micrófono gama alta On-TOP", marca: "On-TOP", categoria: "Audio", stock: 1, precio: 550.0, imagen: "images/ONTOP-HIGH.jpg" },
      { id: "BB-BT668N", producto: "BlackBlack BT-668N", marca: "BlackBlack", categoria: "Audio", stock: 1, precio: 140.0, imagen: "images/BB-BT668N.jpg" },
      { id: "TUMAN-X4", producto: "Micrófono x4 Tuman (pack)", marca: "Tuman", categoria: "Audio", stock: 5, precio: 280.0, imagen: "images/TUMAN-X4.jpg" },
      { id: "OP-9011B", producto: "Kit Solar / Linterna OPALUX", marca: "Opalux", categoria: "Tecnología", stock: 20, precio: 120.0, imagen: "images/OP-9011B.jpg" },
      { id: "BT-149-C", producto: "SET-5 Colores Bolsa / Esponja Micrófono “Batblack”", marca: "Batblack", categoria: "Audio", stock: 5, precio: 16.0, imagen: "images/BT-149-C.jpg" },
      { id: "PSBRS", producto: "Consola Digital PRO SERIES (8 canales)", marca: "ProSeries", categoria: "Audio", stock: 2, precio: 450.0, imagen: "images/PSBRS.jpg" },
      { id: "BT-U168", producto: "Micrófono Pro Batblack inalámbrico UHF", marca: "Batblack", categoria: "Audio", stock: 2, precio: 420.0, imagen: "images/BT-U168.jpg" },
      { id: "BT-4D2C", producto: "Consola Amplificada Batblack 600W", marca: "Batblack", categoria: "Audio", stock: 1, precio: 450.9, imagen: "images/BT-4D2C.jpg" },
      { id: "CAJA15B", producto: "Caja Amplificada 15”", marca: "Genérica", categoria: "Audio", stock: 2, precio: 900.0, imagen: "images/CAJA15B.jpg" },
      { id: "CHARG-USB-C", producto: "Cargador Rápido USB-C", marca: "Genérica", categoria: "Tecnología", stock: 10, precio: 8.0, imagen: "images/CHARG-USB-C.jpg" },
      { id: "SOP-MAG", producto: "Soporte Magnético Celular", marca: "Genérica", categoria: "Tecnología", stock: 8, precio: 35.0, imagen: "images/SOP-MAG.jpg" },
      { id: "BTD9G", producto: "Micrófono profesional Batblack inalámbrico UHF", marca: "Batblack", categoria: "Audio", stock: 11, precio: 259.0, imagen: "images/BTD9G.jpg" },
      { id: "BTN-58B", producto: "Micrófono Batblack dinámico profesional unidireccional", marca: "Batblack", categoria: "Audio", stock: 4, precio: 75.0, imagen: "images/BTN-58B.jpg" },
      { id: "BTP4X", producto: "Mixer 4 canales profesional Batblack 15V", marca: "Batblack", categoria: "Audio", stock: 3, precio: 220.0, imagen: "images/BTP4X.jpg" },
      { id: "SNH", producto: "Micrófono Sennheiser E85", marca: "Sennheiser", categoria: "Audio", stock: 0, precio: 120.0, imagen: "images/SNH.jpg" }
    ];

    const productList = document.getElementById("productList");
    const searchInput = document.getElementById("searchInput");
    const categoryFilter = document.getElementById("categoryFilter");
    const priceFilter = document.getElementById("priceFilter");
    const noResults = document.getElementById("noResultsMessage");

    function renderProducts(list) {
      productList.innerHTML = "";
      if (list.length === 0) {
        noResults.classList.remove("d-none");
        return;
      }
      noResults.classList.add("d-none");

      list.forEach(p => {
        const stockClass = p.stock <= 2 ? "low-stock" : "in-stock";
        const imgSrc = p.imagen ? p.imagen : "images/default.jpg";

        productList.innerHTML += `
          <div class="col" data-price="${p.precio}" data-category="${p.categoria}">
            <div class="inventory-card p-3 h-100 d-flex flex-column">
              <img src="${imgSrc}" alt="${p.producto}" class="product-image mb-3" onerror="if(!this.dataset.fallback){this.dataset.fallback='true';this.src='images/default.jpg';}">
              <h5 class="text-white">${p.producto}</h5>
              <p class="text-secondary flex-grow-1">Marca: ${p.marca} (ID: ${p.id})</p>
              <div class="d-flex justify-content-between align-items-center mt-2">
                <span class="fs-5 fw-bold text-light">S/ ${p.precio.toFixed(2)}</span>
                <span class="stock-indicator ${stockClass}">STOCK: ${p.stock}</span>
              </div>
            </div>
          </div>`;
      });
    }

    function applyFilters() {
      const search = searchInput.value.toLowerCase();
      const category = categoryFilter.value;
      const priceOrder = priceFilter.value;

      let filtered = productos.filter(p => 
        (category === "all" || p.categoria === category) &&
        (p.producto.toLowerCase().includes(search) || p.id.toLowerCase().includes(search))
      );

      if (priceOrder === "asc") filtered.sort((a, b) => a.precio - b.precio);
      if (priceOrder === "desc") filtered.sort((a, b) => b.precio - a.precio);

      renderProducts(filtered);
    }

    searchInput.addEventListener("input", applyFilters);
    categoryFilter.addEventListener("change", applyFilters);
    priceFilter.addEventListener("change", applyFilters);

    renderProducts(productos);

    // Sidebar responsive
    const sidebar = document.getElementById("sidebar");
    document.getElementById("menuToggle").addEventListener("click", () => sidebar.classList.add("show-sidebar"));
    document.getElementById("closeSidebar").addEventListener("click", () => sidebar.classList.remove("show-sidebar"));
  </script>
</body>
</html>
